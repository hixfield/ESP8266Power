# PCB
*(click for high resolution image)*

| Top                                              | Bottom                                                    |
|--------------------------------------------------|-----------------------------------------------------------|
| [![PCB top view](images/pcbtop_lowres.jpg)](images/pcbtop.jpg) | [![PCB bottom view](images/pcbbottom_lowres.jpg)](images/pcbbottom.jpg) |

# Schematic
(the repository contains the EagleCAD file)
![image of schematic](images/schematic.png)

# Components
## bill of materials
| Qty needed | Qty delivered | Part                                     | Value                    | Description                                                           | picture                                | 
|------------|---------------|------------------------------------------|--------------------------|-----------------------------------------------------------------------|----------------------------------------| 
| 2          | 3             | C1, C2                                   | 47uF                     | SMD, tantalum capacitor, 1206                                         | [picture](images/1206_cap_47uf.jpg)    | 
| 2          | 3             | C3, C4                                   | 100nF                    | SMD, capacitor, 1206                                                  | [picture](images/1206_cap_100nf.jpg)   | 
| 1          | 1             | C6                                       | 680uF / 4V               | Through hole, electrolytic capacitor, diameter 8mm, 3.5mm pin spacing | [picture](images/th_cap.jpg)          | 
| 10         | 11            | R1, R2, R3, R4, R5, R6, R7, R8, R10, R15 | 10K                      | SMD, resistor, 1206                                                   | [picture](images/1206_res_10k.jpg)     | 
| 1          | 2             | R9                                       | 4.7K                     | SMD, resistor, 1206                                                   | [picture](images/1206_res_4.7k.jpg)    | 
| 2          | 3             | R11, R12                                 | 330                      | SMD, resistor, 1206                                                   | [picture](images/1206_res_330.jpg)     | 
| 1          | 2             | R13                                      | 2.2K                     | SMD, resistor, 1206                                                   | [picture](images/1206_res_2.2k.jpg)    | 
| 1          | 1             | R14                                      | S10K275                  | Through hole, varistor                                                | [picture](images/th_s10k275.jpg)       | 
| 1          | 1             | F1                                       | 800mA                    | "Through hole, fuse, 8.35mm x 4 mm, 0.2"" (5.08mm) pin spacing "      | [picture](images/th_fuse_800ma.jpg)    | 
| 1          | 2             | LED1                                     | Red                      | SMD, led, 1206                                                        | [picture](images/1206_led_red.jpg)     | 
| 1          | 2             | D1                                       | BAV103                   | SMD, diode, SOD80                                                     | [picture](images/sod80_bav103.jpg)     | 
| 3          | 4             | T1, T2, T3                               | BC847C                   | SMD, NPN Transistor, SOT23                                            | [picture](images/sot23_bc847c.jpg)     | 
| 1          | 1             | B1                                       | 5V                       | "Through hole, buzzer, diameter 12mm, 0.3"" (7.62mm) pin spacing"     | [picture](images/th_buzzer.jpg)        | 
| 1          | 1             | U1                                       | ESP12E                   | SMD, ESP12E module                                                    | [picture](images/esp12e.jpg)           | 
| 1          | 1             | U2                                       | LM3940                   | SMD, Low drop voltage regulator, SOT223                               | [picture](images/sot223_lm3940.jpg)    | 
| 1          | 1             | U3                                       | HLK-PM01                 | Through hole, power module, HiLink HLK-PM01                           | [picture](images/th_hlk-pm01.jpg)      | 
| 1          | 1             | J1                                       | FTDI                     | "Through hole, header female,  6P,  0.1"" (2.54mm) pin spacing"       | [picture](images/th_ftdi.jpg)          | 
| 2          | 2             | S1, S2                                   | PROG, RST                | SMD Push button                                                       | [picture](images/micropushbutton.jpg)  | 
| 1          | 1             | S3                                       | SRD-05VDC-SL-C           | Through hole, Relay SRD-05VDC-SL-C                                    | [picture](images/relay.jpg)            | 
| 2          | 2             | PIR, SW                                  | XH3P                     | Through hole, Connector male XH3P straight                            | [picture](images/th_xh3pmale.jpg)      | 
| 1          | 1             | DS18B20 temp sensor encased              |                          | Module, DS18B20 temp sensor encased                                   | [picture](images/ds18b20.jpg)          | 
| 1          | 1             | PIR Module                               |                          | Module, PIR                                                           | [picture](images/pirmodule.jpg)        | 
| 1          | 1             | Switch with led                          |                          | Switch with led                                                       | [picture](images/pushbutton.jpg)       | 
| 2          | 2             | XH3P female no pins                      |                          | XH3P female no pins                                                   | [picture](images/xh3pfemalesolder.jpg) | 
| 2          | 2             | XH3P wire 10cm [pin -> solder], black    |                          | XH3P wire 10cm [pin -> solder], black                                 | [picture](images/xh3pfemalesolder.jpg) | 
| 1          | 1             | XH3P wire 10cm [pin -> solder], red      |                          | XH3P wire 10cm [pin -> solder], red                                   | [picture](images/xh3pfemalesolder.jpg) | 
| 1          | 1             | XH3P wire 10cm [pin -> solder], yellow   |                          | XH3P wire 10cm [pin -> solder], yellow                                | [picture](images/xh3pfemalesolder.jpg) | 
| 2          | 2             | XH3P wire 10cm [pin -> solder], white    |                          | XH3P wire 10cm [pin -> solder], white                                 | [picture](images/xh3pfemalesolder.jpg) | 
| 1          | 1             | Case                                     |                          | Case BOPLA 43432501, predrilled                                       | [picture](images/case.jpg)             | 
| 1          | 1             | PCB                                      |                          | Custom PCB                                                            | [picture](images/pcb.jpg)              | 
| 2          | 2             | Cable lug round M3                       |                          | Cable lug round M3                                                    | [picture](images/cablelugroundm3.jpg)  | 
| 1          | 1             | Cable lug fork M4                        |                          | Cable lug fork M4                                                     | [picture](images/cablelugforkm4.jpg)   | 
| 1          | 1             | Heat shrink tubing 1,5mm, 2.5mm, 6mm, 8mm|                          | Heat shrink tubing 1,5mm, 2.5mm, 6mm, 8mm                             | [picture](images/heatshrinktubing.jpg) | 
| 3          | 3             | PCB Fixation screw                       |                          | Allen screw, inox, M3 x 6mm thread length                             | [picture](images/screw.jpg)            | 
| 1          | 1             | 1.5mm2 x 55mm mains wire brown           |                          | 1.5mm2 x 55mm mains wire brown                                        | [picture](images/mainswire.jpg)        | 
| 1          | 1             | 1.5mm2 x 55mm mains wire blue            |                          | 1.5mm2 x 55mm mains wire blue                                         | [picture](images/mainswire.jpg)        | 
| 1          | 1             | 1.5mm2 x 55mm mains wire yellow/green    |                          | 1.5mm2 x 55mm mains wire yellow/green                                 | [picture](images/mainswire.jpg)        | 

## overview
![all parts](images/allparts.jpg)

# Assembly instructions
## soldering of the PCB
### Step 0: BC847 transistors
![assembling step 1](images/assembly_step_0.jpg)
### Step 1: 10K resistors
![assembling step 1](images/assembly_step_1.jpg)
### Step 2: 4.7K resistors
![assembling step 1](images/assembly_step_2.jpg)
### Step 3: 330 resistors
![assembling step 1](images/assembly_step_3.jpg)
### Step 4: 2.2K resistors
![assembling step 1](images/assembly_step_4.jpg)
### Step 5: 100nF capacitors
![assembling step 1](images/assembly_step_5.jpg)
### Step 6: 47uF tantalum capacitors
![assembling step 1](images/assembly_step_6.jpg)
### Step 7: LM3940 voltage controller
![assembling step 1](images/assembly_step_7.jpg)
### Step 8: LED
![assembling step 1](images/assembly_step_8.jpg)
### Step 9: Diode
![assembling step 1](images/assembly_step_9.jpg)
### Step 10: ESP12E
![assembling step 1](images/assembly_step_10.jpg)
### Step 11: Push buttons
![assembling step 1](images/assembly_step_11.jpg)
### Step 12: 680uF capacitor 
![assembling step 1](images/assembly_step_12.jpg)
### Step 13: connectors
![assembling step 1](images/assembly_step_13.jpg)
### Step 14: buzzer
![assembling step 1](images/assembly_step_14.jpg)
### Step 15: relay
![assembling step 1](images/assembly_step_15.jpg)
### Step 16: power supply
![assembling step 1](images/assembly_step_16.jpg)
### Step 17: FTDI connector
![assembling step 1](images/assembly_step_17.jpg)
### Step 18: Fuse
![assembling step 1](images/assembly_step_18.jpg)
### Step 19: Varistor
![assembling step 1](images/assembly_step_19.jpg)
## Assemble main wires
### Step 29: neutral (blue) and live (brown) mains connection wires
![assembling step 1](images/assembly_step_20.jpg)
### Step 21: earthing wire (yellow/green)
![assembling step 1](images/assembly_step_21.jpg)
## Assemble push button
### Step 22: prepare wires
![assembling step 1](images/assembly_step_22.jpg)
### Step 23: connect (black) GND wire
![assembling step 1](images/assembly_step_23.jpg)
### Step 24: connect (white) SWITCH wire
![assembling step 1](images/assembly_step_24.jpg)
### Step 25: connect (yellow) + LED wire
![assembling step 1](images/assembly_step_25.jpg)
### Step 26: shrink and put in housing
![assembling step 1](images/assembly_step_26.jpg)
## Assemble PIR
### Step 27: prepare and connect wires
![assembling step 1](images/assembly_step_27.jpg)
### Step 28: shrink and put in housing
![assembling step 1](images/assembly_step_28.jpg)
### Step 29: adjust settings
![assembling step 1](images/assembly_step_29.jpg)

- refer to [HC-SR501 Motion Sensor Tutorial]([http://henrysbench.capnfatz.com/henrys-bench/arduino-sensors-and-input/arduino-hc-sr501-motion-sensor-tutorial/#attachment%20wp-att-2111/0/]) http://henrysbench.capnfatz.com/henrys-bench/arduino-sensors-and-input/arduino-hc-sr501-motion-sensor-tutorial/#attachment%20wp-att-2111/0/
- trigger selection jumper => recommended REPEATABLE TRIGGER
- set correct sensitivy and delay setings (variable resistors)
 * Sensitivity Adjust => recommended MIDDLE
 * Time Delay Adjust  => recommended MINIMUM

## Prepare temperature sensor
![assembling step 1](images/assembly_step_30.jpg)


##Build PCB in the case
- solder the temperature sensor to the pcb
 - red = 3.3v
 - black = GND
 - blue = DATA  
- put PCB in case and fix using the screws
- put the temp sensor through the hole in the case
- connect the mains and earth wires to the power pins in the case
- cut 10 mm of heat shrink tube 8mm and slide it over the temperature sensor to fix it

## Programming via the FTDI connector
If you want to program manually via the FTDI connector:

- DO NOT 	PLUG THE DEVICE IN THE POWER !
- put in your USB -> SERIAL connector
- Push the onboard buttons in the correct sequence:
 - push and keep pushing the PROG button
 - push the RESET (while keeping PROG pressed)
 - release both butons
- De device is now in programming mode 	

##Assemble front
- mount the push button in the front of the case
- fix / glue the PIR sensor in the front of the case

##Assemble the device
- assemble front and back of case
 - connect push button connector
 - connect PIR connector
- close case and put in the screws  

# Packaging
- 330 gr (including box)
- ideal box would be approx 70mm x 130mm x 100 mm
# Case preparation
[![PCB top view](images/casepreparation.jpg)](movies/casepreparation.mp4)




